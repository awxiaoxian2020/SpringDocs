<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>使用 Spring Boot</title>
<link rel="stylesheet" href="css/site.css">
<script src="js/setup.js"></script><script defer src="js/site.js"></script>

</head>
<body id="using-boot" class="book toc2 toc-left"><div id="banner-container" class="container" role="banner">
  <div id="banner" class="contained" role="banner">
    <div id="switch-theme">
      <input type="checkbox" id="switch-theme-checkbox" />
      <label for="switch-theme-checkbox">Dark Theme</label>
    </div>
  </div>
</div>
<div id="tocbar-container" class="container" role="navigation">
  <div id="tocbar" class="contained" role="navigation">
    <button id="toggle-toc"></button>
  </div>
</div>
<div id="main-container" class="container">
  <div id="main" class="contained">
    <div id="doc" class="doc">
<div id="header">
<h1>使用 Spring Boot</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<span id="back-to-index"><a href="index.html">Back to index</a></span><ul class="sectlevel1">
<li><a href="#using-boot-build-systems">1. 构建系统</a>
<ul class="sectlevel2">
<li><a href="#using-boot-dependency-management">1.1. 依赖管理</a></li>
<li><a href="#using-boot-maven">1.2. Maven</a></li>
<li><a href="#using-boot-gradle">1.3. Gradle</a></li>
<li><a href="#using-boot-ant">1.4. Ant</a></li>
<li><a href="#using-boot-starter">1.5. Starters</a></li>
</ul>
</li>
<li><a href="#using-boot-structuring-your-code">2. 组织代码</a>
<ul class="sectlevel2">
<li><a href="#using-boot-using-the-default-package">2.1. 使用 &#8220;default&#8221; 包</a></li>
<li><a href="#using-boot-locating-the-main-class">2.2. 定位主应用类</a></li>
</ul>
</li>
<li><a href="#using-boot-configuration-classes">3. 配置类</a>
<ul class="sectlevel2">
<li><a href="#using-boot-importing-configuration">3.1. 导入额外的配置类</a></li>
<li><a href="#using-boot-importing-xml-configuration">3.2. 导入 XML 配置</a></li>
</ul>
</li>
<li><a href="#using-boot-auto-configuration">4. 自动配置</a>
<ul class="sectlevel2">
<li><a href="#using-boot-replacing-auto-configuration">4.1. 平滑替换自动配置</a></li>
<li><a href="#using-boot-disabling-specific-auto-configuration">4.2. 禁用指定的自动配置类</a></li>
</ul>
</li>
<li><a href="#using-boot-spring-beans-and-dependency-injection">5. Spring Bean 与依赖注入</a></li>
<li><a href="#using-boot-using-springbootapplication-annotation">6. 使用 @SpringBootApplication 注解</a></li>
<li><a href="#using-boot-running-your-application">7. 运行您的应用</a>
<ul class="sectlevel2">
<li><a href="#using-boot-running-from-an-ide">7.1. 使用 IDE 运行</a></li>
<li><a href="#using-boot-running-as-a-packaged-application">7.2. 作为打包应用运行</a></li>
<li><a href="#using-boot-running-with-the-maven-plugin">7.3. 使用 Maven 插件</a></li>
<li><a href="#using-boot-running-with-the-gradle-plugin">7.4. 使用 Gradle 插件</a></li>
<li><a href="#using-boot-hot-swapping">7.5. 热交换</a></li>
</ul>
</li>
<li><a href="#using-boot-devtools">8. 开发者工具</a>
<ul class="sectlevel2">
<li><a href="#using-boot-devtools-property-defaults">8.1. Property 默认值</a></li>
<li><a href="#using-boot-devtools-restart">8.2. 自动重启</a>
<ul class="sectlevel3">
<li><a href="#using-boot-devtools-restart-logging-condition-delta">8.2.1. 条件评估变更日志</a></li>
<li><a href="#using-boot-devtools-restart-exclude">8.2.2. 排除资源</a></li>
<li><a href="#using-boot-devtools-restart-additional-paths">8.2.3. 监视附加路径</a></li>
<li><a href="#using-boot-devtools-restart-disable">8.2.4. 禁用重启</a></li>
<li><a href="#using-boot-devtools-restart-triggerfile">8.2.5. 使用触发文件</a></li>
<li><a href="#using-boot-devtools-customizing-classload">8.2.6. 自定义重启类加载器</a></li>
<li><a href="#using-boot-devtools-known-restart-limitations">8.2.7. 已知限制</a></li>
</ul>
</li>
<li><a href="#using-boot-devtools-livereload">8.3. LiveReload</a></li>
<li><a href="#using-boot-devtools-globalsettings">8.4. 全局设置</a>
<ul class="sectlevel3">
<li><a href="#configuring-file-system-watcher">8.4.1. 配置文件系统监视器</a></li>
</ul>
</li>
<li><a href="#using-boot-devtools-remote">8.5. 远程应用</a>
<ul class="sectlevel3">
<li><a href="#运行远程客户端应用">8.5.1. 运行远程客户端应用</a></li>
<li><a href="#using-boot-devtools-remote-update">8.5.2. 远程更新</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#using-boot-packaging-for-production">9. 打包生产应用</a></li>
<li><a href="#using-boot-whats-next">10. 下一步</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>本章节将详细介绍如何使用 Spring Boot. 它覆盖了诸如构建系统、自动配置和如何运行应用等主题. 我们还介绍一些 Spring Boot 最佳实践. 虽然 Spring Boot 并没有什么特别 (它只是另一个您可以使用的类库) ,但仍然有一些建议可以让您的开发工作变得更加容易.</p>
</div>
<div class="paragraph">
<p>如果您是刚开始使用 Spring Boot,那么在深入本部分之前,您应该先阅读 <em><a href="getting-started.html#getting-started">入门部分</a></em> .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-build-systems"><a class="anchor" href="#using-boot-build-systems"></a>1. 构建系统</h2>
<div class="sectionbody">
<div class="paragraph">
<p>强烈推荐您选择一个支持<a href="#using-boot-dependency-management"><em>依赖管理</em></a>的构建系统, 您可以使用它将 artifact 发布到 Maven Central 仓库. 我们建议您选择 Maven 或者 Gradle. 虽然可以让 Spring Boot 与其它构建系统 (如 Ant) 配合工作,但它们不会得到特别好的支持.</p>
</div>
<div class="sect2">
<h3 id="using-boot-dependency-management"><a class="anchor" href="#using-boot-dependency-management"></a>1.1. 依赖管理</h3>
<div class="paragraph">
<p>每一次 Spring Boot 发行都提供了一个它所支持的依赖清单. 实际上,您不需要为构建配置提供任何依赖的版本,因为 Spring Boot 已经帮您管理这些了. 当您升级 Spring Boot 时,这些依赖也将以一致的方式进行升级.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
如果您觉得有必要,您仍然可以指定一个版本并覆盖 Spring Boot 所推荐的.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>该清单包含了全部可以与 Spring Boot 一起使用的 spring 模块以及第三方类库,可作为 标准依赖清单 (<code>spring-boot-dependencies</code>) ,并且可以与 <a href="#using-boot-maven">Maven</a> 和 <a href="#using-boot-gradle">Gradle</a> 一起使用.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Spring Boot 的每一次发行都会基于一个 Spring Framework 版本,因此我们强烈建议您不要指定它的版本.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-maven"><a class="anchor" href="#using-boot-maven"></a>1.2. Maven</h3>
<div class="paragraph">
<p>要了解有关将 Spring Boot 与 Maven 结合使用的信息,请参阅 Spring Boot 的 Maven 插件的文档</p>
</div>
<div class="ulist">
<ul>
<li>
<p>参考文档 (<a href="https://docs.spring.io/spring-boot/docs/2.4.5/maven-plugin/reference/htmlsingle/">HTML</a> 和 <a href="https://docs.spring.io/spring-boot/docs/2.4.5/maven-plugin/reference/pdf/spring-boot-maven-plugin-reference.pdf">PDF</a>)</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.4.5/maven-plugin/api/">API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-gradle"><a class="anchor" href="#using-boot-gradle"></a>1.3. Gradle</h3>
<div class="paragraph">
<p>要了解如何使用 Spring Boot 和 Gradle,请参阅 Spring Boot 的 Gradle 插件文档:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>参考文档 (<a href="https://docs.spring.io/spring-boot/docs/2.4.5/gradle-plugin/reference/htmlsingle/">HTML</a> 和 <a href="https://docs.spring.io/spring-boot/docs/2.4.5/gradle-plugin/reference/pdf/spring-boot-gradle-plugin-reference.pdf">PDF</a>)</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.4.5/gradle-plugin/api/">API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-ant"><a class="anchor" href="#using-boot-ant"></a>1.4. Ant</h3>
<div class="paragraph">
<p>可以使用 Apache Ant+Ivy 构建 Spring Boot 项目. <code>spring-boot-antlib</code> AntLib 模块也可以帮助 Ant 创建可执行 jar 文件.</p>
</div>
<div class="paragraph">
<p>要声明依赖,可参考以下一个典型的 <code>ivy.xml</code> 文件内容:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;ivy-module version="2.0"&gt;
    &lt;info organisation="org.springframework.boot" module="spring-boot-sample-ant" /&gt;
    &lt;configurations&gt;
        &lt;conf name="compile" description="everything needed to compile this module" /&gt;
        &lt;conf name="runtime" extends="compile" description="everything needed to run this module" /&gt;
    &lt;/configurations&gt;
    &lt;dependencies&gt;
        &lt;dependency org="org.springframework.boot" name="spring-boot-starter"
            rev="${spring-boot.version}" conf="compile" /&gt;
    &lt;/dependencies&gt;
&lt;/ivy-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>一个典型的 <code>build.xml</code> 大概是这样:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;project
    xmlns:ivy="antlib:org.apache.ivy.ant"
    xmlns:spring-boot="antlib:org.springframework.boot.ant"
    name="myapp" default="build"&gt;

    &lt;property name="spring-boot.version" value="2.4.5" /&gt;

    &lt;target name="resolve" description="--&gt; retrieve dependencies with ivy"&gt;
        &lt;ivy:retrieve pattern="lib/[conf]/[artifact]-[type]-[revision].[ext]" /&gt;
    &lt;/target&gt;

    &lt;target name="classpaths" depends="resolve"&gt;
        &lt;path id="compile.classpath"&gt;
            &lt;fileset dir="lib/compile" includes="*.jar" /&gt;
        &lt;/path&gt;
    &lt;/target&gt;

    &lt;target name="init" depends="classpaths"&gt;
        &lt;mkdir dir="build/classes" /&gt;
    &lt;/target&gt;

    &lt;target name="compile" depends="init" description="compile"&gt;
        &lt;javac srcdir="src/main/java" destdir="build/classes" classpathref="compile.classpath" /&gt;
    &lt;/target&gt;

    &lt;target name="build" depends="compile"&gt;
        &lt;spring-boot:exejar destfile="build/myapp.jar" classes="build/classes"&gt;
            &lt;spring-boot:lib&gt;
                &lt;fileset dir="lib/runtime" /&gt;
            &lt;/spring-boot:lib&gt;
        &lt;/spring-boot:exejar&gt;
    &lt;/target&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
如果您不想使用 <code>spring-boot-antlib</code> 模块,请参阅 <em><a href="howto.html#howto-build-an-executable-archive-with-ant">使用 Ant 构建可执行归档文件</a></em>,无需使用 <code>spring-boot-antlib</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-starter"><a class="anchor" href="#using-boot-starter"></a>1.5. Starters</h3>
<div class="paragraph">
<p>Starter 是一组惯例依赖描述资源,可以包含在应用中. 从 starter 中,您可以获得所需的所有 Spring 和相关技术的一站式支持,无须通过示例代码和复制粘贴来获取依赖. 比如,如果您要使用 Spring 和 JPA 进行数据库访问,那么只需要在项目中包含 <code>spring-boot-starter-data-jpa</code> 依赖即可.</p>
</div>
<div class="paragraph">
<p>starter 包含了许多您需要用于使项目快速启动和运行,并且需要一组受支持的可传递依赖的依赖.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">命名含义</div>
<div class="paragraph">
<p>官方的所有 starter 都遵循类似的命名规则: <code>spring-boot-starter-*</code>,其中 <code>*</code> 是特定类型的应用. 这个命名结构旨在帮助您找到 starter. 许多 IDE 中 Maven 集成允许您按名称搜索依赖. 例如,安装了 Eclipse 或者 STS 插件后,您可以简单地在 POM 编辑器中按下 <code>ctrl-space</code> 并输入 <code>spring-boot-starter</code> 来获取完整的列表.</p>
</div>
<div class="paragraph">
<p>正如 &#8220;<a href="spring-boot-features.html#boot-features-custom-starter">创建自己的 starter</a>&#8221; 章节所述,第三方的 starter 命名不应该以 <code>spring-boot</code> 开头,因为它是官方 Spring Boot artifacts 所保留的规则. 例如,有一个第三方 starter 项目叫做 <code>thirdpartyproject</code>,它通常会命名为 <code>thirdpartyproject-spring-boot-starter</code>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Spring Boot 在 <code>org.springframework.boot group</code> 下提供了以下应用 starter:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Spring Boot 应用类 Starter</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter"></a><code>spring-boot-starter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">核心的 starter, 包含自动配置,日志和 YAML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-activemq"></a><code>spring-boot-starter-activemq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Apache ActiveMQ 传递 JMS 消息的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-amqp"></a><code>spring-boot-starter-amqp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring AMQP 和 Rabbit MQ Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-aop"></a><code>spring-boot-starter-aop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring AOP 和 AspectJ 的面向切面编程的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-artemis"></a><code>spring-boot-starter-artemis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Apache Artemis 传递 JMS 消息的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-batch"></a><code>spring-boot-starter-batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Batch 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-cache"></a><code>spring-boot-starter-cache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Framework 的缓存支持的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-cloud-connectors"></a><code>spring-boot-starter-cloud-connectors</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Cloud Connectors 的 Starter ,可简化 Cloud Foundry 和 Heroku 等云平台服务之间的连接. 弃用 Java CFEnv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-cassandra"></a><code>spring-boot-starter-data-cassandra</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Cassandra distributed database 和 Spring Data Cassandra 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-cassandra-reactive"></a><code>spring-boot-starter-data-cassandra-reactive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Cassandra distributed 和 and Spring Data Cassandra Reactive Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-couchbase"></a><code>spring-boot-starter-data-couchbase</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Couchbase document-oriented database 和 Spring Data Couchbase Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-couchbase-reactive"></a><code>spring-boot-starter-data-couchbase-reactive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Couchbase document-oriented database 和 Spring Data Couchbase Reactive Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-elasticsearch"></a><code>spring-boot-starter-data-elasticsearch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Elasticsearch 搜索分析引擎和 Spring Data Elasticsearch 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-jdbc"></a><code>spring-boot-starter-data-jdbc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data JDBC 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-jpa"></a><code>spring-boot-starter-data-jpa</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Hibernate 的 Spring Data JPA 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-ldap"></a><code>spring-boot-starter-data-ldap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data LDAP 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-mongodb"></a><code>spring-boot-starter-data-mongodb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 MongoDB 文档数据库 和 Spring Data MongoDB 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-mongodb-reactive"></a><code>spring-boot-starter-data-mongodb-reactive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 MongoDB 文档数据库 和 Spring Data MongoDB Reactive Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-neo4j"></a><code>spring-boot-starter-data-neo4j</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data Neo4j 支持 Neo4j graph database 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-r2dbc"></a><code>spring-boot-starter-data-r2dbc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data R2DBC 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-redis"></a><code>spring-boot-starter-data-redis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data Redis 和 Lettuce 客户端支持 Redis key-value 数据存储 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-redis-reactive"></a><code>spring-boot-starter-data-redis-reactive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data Redis reactive 和 Lettuce 客户端支持 Redis key-value 数据存储 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-rest"></a><code>spring-boot-starter-data-rest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data REST 将 Spring Data 存储库以 REST 形式暴露的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-data-solr"></a><code>spring-boot-starter-data-solr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Data Solr 来支持 Apache Solr search platform. 2.3.9 后弃用</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-freemarker"></a><code>spring-boot-starter-freemarker</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 FreeMarker 视图构建 MVC web 应用程序</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-groovy-templates"></a><code>spring-boot-starter-groovy-templates</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Groovy Templates 视图构建 MVC web 应用程序</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-hateoas"></a><code>spring-boot-starter-hateoas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring MVC 和 Spring HATEOAS 构建超媒体 RESTful web 应用程序</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-integration"></a><code>spring-boot-starter-integration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Integration 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-jdbc"></a><code>spring-boot-starter-jdbc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 HikariCP 连接池的 JDBC 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-jersey"></a><code>spring-boot-starter-jersey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 JAX-RS 和 Jersey 构建 RESTful web 应用程序. <a href="#spring-boot-starter-web"><code>spring-boot-starter-web</code></a> 的替代方法</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-jooq"></a><code>spring-boot-starter-jooq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 jOOQ 访问 SQL 数据库. <a href="#spring-boot-starter-data-jpa"><code>spring-boot-starter-data-jpa</code></a> 或 <a href="#spring-boot-starter-jdbc"><code>spring-boot-starter-jdbc</code></a> 的替代方法</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-json"></a><code>spring-boot-starter-json</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">json 读写的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-jta-atomikos"></a><code>spring-boot-starter-jta-atomikos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Atomikos 的 JTA transactions 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-jta-bitronix"></a><code>spring-boot-starter-jta-bitronix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Bitronix 的 JTA transactions 的 Starter. 2.3.0 已弃用</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-mail"></a><code>spring-boot-starter-mail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Java Mail 和 Spring Framework 邮件发送的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-mustache"></a><code>spring-boot-starter-mustache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Mustache 视图构建 web 应用程序的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-oauth2-client"></a><code>spring-boot-starter-oauth2-client</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Security 的 OAuth2/OpenID Connect 客户端功能的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-oauth2-resource-server"></a><code>spring-boot-starter-oauth2-resource-server</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Security 的 OAuth2 资源服务器功能的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-quartz"></a><code>spring-boot-starter-quartz</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Quartz scheduler 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-rsocket"></a><code>spring-boot-starter-rsocket</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">构建 RSocket 客户端 和 服务端的 Starter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-security"></a><code>spring-boot-starter-security</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Security 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-test"></a><code>spring-boot-starter-test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 JUnit Jupiter, Hamcrest 和 Mockito 等库测试 Spring Boot 应用程序的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-thymeleaf"></a><code>spring-boot-starter-thymeleaf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Thymeleaf 视图构建 MVC web 应用程序</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-validation"></a><code>spring-boot-starter-validation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Hibernate Validator 进行 Java Bean Validation 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-web"></a><code>spring-boot-starter-web</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring MVC 构建 web (包括 RESTful) 应用程序. 使用 Tomcat 作为默认的嵌入式容器.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-web-services"></a><code>spring-boot-starter-web-services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Web Services 的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-webflux"></a><code>spring-boot-starter-webflux</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Framework 对 Reactive Web 的支持来构建 WebFlux 应用程序的 Starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-websocket"></a><code>spring-boot-starter-websocket</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Framework 对 WebSocket 的支持来构建 WebSocket 应用程序的 Starter</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>除了应用程序的 starter 外,以下 starter 可用于添加 <em><a href="production-ready-features.html#production-ready">生产就绪</a></em> 特性:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Spring Boot 生产类 starter</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-actuator"></a><code>spring-boot-starter-actuator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Spring Boot 的 Actuator 的 Starter,该启动器提供了生产就绪功能,可帮助您监视和管理应用程序</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>最后,Spring Boot 还包含以下 starter,如果您想要排除或切换其他特定技术,可以使用以下 starter:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Spring Boot 技术类 starter</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-jetty"></a><code>spring-boot-starter-jetty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Jetty 作为嵌入式容器. <a href="#spring-boot-starter-tomcat"><code>spring-boot-starter-tomcat</code></a> 的替代方法</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-log4j2"></a><code>spring-boot-starter-log4j2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Log4j2 来记录日志. <a href="#spring-boot-starter-logging"><code>spring-boot-starter-logging</code></a> 的替代方法</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-logging"></a><code>spring-boot-starter-logging</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Logback 来记录日志. 默认的日志 starter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-reactor-netty"></a><code>spring-boot-starter-reactor-netty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Reactor Netty 作为嵌入的 reactive HTTP server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-tomcat"></a><code>spring-boot-starter-tomcat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Tomcat 作为嵌入 servlet 容器. <a href="#spring-boot-starter-web"><code>spring-boot-starter-web</code></a> 使用此作为默认 Servlet 容器</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="spring-boot-starter-undertow"></a><code>spring-boot-starter-undertow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 Undertow 作为嵌入 servlet 容器. <a href="#spring-boot-starter-tomcat"><code>spring-boot-starter-tomcat</code></a> 的替代方法</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>要了解如何交换技术方面的信息,请参阅 <a href="howto.html#howto-use-another-web-server">swapping web server</a> and <a href="howto.html#howto-configure-log4j-for-logging">logging system</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
有关其它社区贡献的 starter 列表,请参阅 GitHub 上的 <code>spring-boot-starters</code> 模块中的 <a href="https://github.com/spring-projects/spring-boot/tree/master/spring-boot-project/spring-boot-starters/README.adoc">README file</a> 文件.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-structuring-your-code"><a class="anchor" href="#using-boot-structuring-your-code"></a>2. 组织代码</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot 不需要任何特定的代码布局,但是有一些最佳实践是很有用的.</p>
</div>
<div class="sect2">
<h3 id="using-boot-using-the-default-package"><a class="anchor" href="#using-boot-using-the-default-package"></a>2.1. 使用 &#8220;default&#8221; 包</h3>
<div class="paragraph">
<p>当一个类没有 <code>package</code> 声明时,它就被认为是在 default 包中. 通常不鼓励使用 default 包,应该避免使用. 对于使用 <code>@ComponentScan</code>、<code>@EntityScan</code> 或者 <code>@SpringBootApplication</code> 注解的 Spring Boot 应用,这样可能会导致特殊问题发生,
因为每一个 jar 中的每一个类将会被读取到.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
我们建议您使用 Java 推荐的包命名约定,并使用域名的反向形式命名 (例如 <code>com.example.project</code>) .
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-locating-the-main-class"><a class="anchor" href="#using-boot-locating-the-main-class"></a>2.2. 定位主应用类</h3>
<div class="paragraph">
<p>我们通常建议您将主应用类放在其它类之上的根包中, <a href="#using-boot-using-springbootapplication-annotation"><code>@SpringBootApplication</code> 注解</a> 注解通常放在主类上,它隐式定义了某些项目的 包扫描的起点.
例如,如果您在编写一个 JPA 应用程序,则被 <code>@SpringBootApplication</code> 注解的类所属的包将被用于搜索标记有 <code>@Entity</code> 注解的类.</p>
</div>
<div class="paragraph">
<p>使用根包还可以允许使用没有指定 <code>basePackage</code> 属性的 <code>@ComponentScan</code> 注解. 如果您的主类在根包中,也可以使用 <code>@SpringBootApplication</code> 注解.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
如果您不想使用 <code>@SpringBootApplication</code>,则可以通过导入的 <code>@EnableAutoConfiguration</code> 和 <code>@ComponentScan</code> 注解来定义该行为,因此也可以使用它们.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>以下是一个经典的包结构:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>com
 +- example
     +- myapplication
         +- Application.java
         |
         +- customer
         |   +- Customer.java
         |   +- CustomerController.java
         |   +- CustomerService.java
         |   +- CustomerRepository.java
         |
         +- order
             +- Order.java
             +- OrderController.java
             +- OrderService.java
             +- OrderRepository.java</pre>
</div>
</div>
<div class="paragraph">
<p><code>Application.java</code> 文件声明了 <code>main</code> 方法,附带了  <code>@SpringBootApplication</code> 注解.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block">package com.example.myapplication;

</span><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-configuration-classes"><a class="anchor" href="#using-boot-configuration-classes"></a>3. 配置类</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot 支持基于 Java 的配置. 虽然可以在 <code>SpringApplication</code> 中使用 XML 配置源,但我们通常建议主配置源为 <code>@Configuration</code> 类. 通常,一个很好的选择是将定义了 <code>main</code> 方法的类作为 <code>@Configuration</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
许多 Spring 的 XML 配置示例已经在 Internet 上发布了. 如果可能的话,您无论如何都应该尝试着使用等效的基于 Java 的配置方式,搜索 <code>Enable*</code> 注解可以帮到您不少忙.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-boot-importing-configuration"><a class="anchor" href="#using-boot-importing-configuration"></a>3.1. 导入额外的配置类</h3>
<div class="paragraph">
<p>你不需要把所有的 <code>@Configuration</code> 放在一个类中. <code>@Import</code> 注解可用于导入其他配置类. 或者,您可以使用 <code>@ComponentScan</code> 自动扫描所有 Spring 组件,包括 <code>@Configuration</code> 类.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-importing-xml-configuration"><a class="anchor" href="#using-boot-importing-xml-configuration"></a>3.2. 导入 XML 配置</h3>
<div class="paragraph">
<p>如果您一定要使用基于 XML 的配置,我们建议您仍然使用 <code>@Configuration</code> 类. 您可以使用 <code>@ImportResource</code> 注解来加载 XML 配置文件.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-auto-configuration"><a class="anchor" href="#using-boot-auto-configuration"></a>4. 自动配置</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot 自动配置尝试根据您添加的 jar 依赖自动配置 Spring 应用. 例如,如果 classpath 下存在 <code>HSQLDB</code>,并且您没有手动配置任何数据库连接 bean,那么 Spring Boot 将自动配置一个内存数据库.</p>
</div>
<div class="paragraph">
<p>您需要通过将 <code>@EnableAutoConfiguration</code> 或者 <code>@SpringBootApplication</code> 注解添加到其中一个 <code>@Configuration</code> 类之上以启用自动配置.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
您应该只添加一个 <code>@SpringBootApplication</code> 或 <code>@EnableAutoConfiguration</code> 注解.  我们通常建议您仅将一个或另一个添加到您的主要 <code>@Configuration</code> 类中.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-boot-replacing-auto-configuration"><a class="anchor" href="#using-boot-replacing-auto-configuration"></a>4.1. 平滑替换自动配置</h3>
<div class="paragraph">
<p>自动配置是非侵入的,您可以随时定义自己的配置来代替自动配置的特定部分. 例如,如果您添加了自己的 <code>DataSource</code> bean,默认的嵌入式数据库支持将不会自动配置.</p>
</div>
<div class="paragraph">
<p>如果您需要了解当前正在应用的自动配置,以及为什么使用,请使用 <code>--debug</code> 开关启动应用. 这样做可以为核心 logger 启用调试日志,并记录到控制台.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-disabling-specific-auto-configuration"><a class="anchor" href="#using-boot-disabling-specific-auto-configuration"></a>4.2. 禁用指定的自动配置类</h3>
<div class="paragraph">
<p>如果您发现在正在使用不需要的自动配置类,可以通过使用 <code>@SpringBootApplication</code> 的 <code>exclude</code> 属性来禁用它们.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.*;
import org.springframework.boot.autoconfigure.jdbc.*;

</span><span class="fold-block">@SpringBootApplication(exclude={DataSourceAutoConfiguration.class})
public class MyApplication {
}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果类不在 classpath 下,您可以使用注解的 <code>excludeName</code> 属性并指定完全类名. 最后,您还可以通过 <code>spring.autoconfigure.exclude</code>  property 控制要排除的自动配置类列表.</p>
</div>
<div class="paragraph">
<p>如果您更喜欢使用 <code>@EnableAutoConfiguration</code> 而不是 <code>@SpringBootApplication</code> ,则还可以使用 <code>exclude</code> 和 <code>excludeName</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
您可以同时使用注解和 property 定义排除项
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
即使自动配置类是 <code>public</code> 的,该类的被认为是 <code>public</code> API 的唯一方面是可用于禁用自动配置的类的名称.  这些类的实际内容 (例如嵌套配置类或 Bean 方法) 仅供内部使用,我们不建议直接使用它们. ,
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-spring-beans-and-dependency-injection"><a class="anchor" href="#using-boot-spring-beans-and-dependency-injection"></a>5. Spring Bean 与依赖注入</h2>
<div class="sectionbody">
<div class="paragraph">
<p>您可以自由使用任何标准的 Spring Framework 技术来定义您的 bean 以及它们注入的依赖. 我们发现使用 <code>@ComponentScan</code> 来寻找 bean 和结合 <code>@Autowired</code> 构造器注入可以很好地工作.</p>
</div>
<div class="paragraph">
<p>如果您按照上述的建议 (将应用类放在根包中) 来组织代码,则可以添加无参的 <code>@ComponentScan</code>. 所有应用组件 (<code>@Component</code>、<code>@Service</code>、<code>@Repository</code>、<code>@Controller</code> 等) 将自动注册为 Spring Bean.</p>
</div>
<div class="paragraph">
<p>以下是一个 <code>@Service</code> Bean,其使用构造注入方式获取一个必需的 <code>RiskAssessor</code> bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block">package com.example.service;

</span><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

</span><span class="fold-block">@Service
public class DatabaseAccountService implements AccountService {

    private final RiskAssessor riskAssessor;

    @Autowired
    public DatabaseAccountService(RiskAssessor riskAssessor) {
        this.riskAssessor = riskAssessor;
    }

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果 bean 中只有一个构造方法,您可以忽略掉 <code>@Autowired</code> 注解.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Service
public class DatabaseAccountService implements AccountService {

    private final RiskAssessor riskAssessor;

    public DatabaseAccountService(RiskAssessor riskAssessor) {
        this.riskAssessor = riskAssessor;
    }

    // ...

}
</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
请注意,构造注入允许 <code>riskAssessor</code> 字段被修饰为 <code>final</code>,这表示以后它不能被更改.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-using-springbootapplication-annotation"><a class="anchor" href="#using-boot-using-springbootapplication-annotation"></a>6. 使用 @SpringBootApplication 注解</h2>
<div class="sectionbody">
<div class="paragraph">
<p>很多 Spring Boot 开发者总是使用 <code>@Configuration</code>、<code>@EnableAutoConfiguration</code> 和 <code>@ComponentScan</code> 注解标记在主类上. 由于 这些注解经常一起使用 (特别是如果您遵循上述的最佳实践) . Spring Boot 提供了一个更方便的 <code>@SpringBootApplication</code> 注解可用来替代这个组合.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableAutoConfiguration</code>: <a href="#using-boot-auto-configuration">启用 Spring Boot 的自动配置机制</a></p>
</li>
<li>
<p><code>@ComponentScan</code>: 在应用程序所在的包上启用 <code>@Component</code> 扫描 (<a href="#using-boot-structuring-your-code">请参阅最佳实践</a>)</p>
</li>
<li>
<p><code>@Configuration</code>: 允许在上下文中注册额外的 bean 或导入其他配置类</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block">package com.example.myapplication;

</span><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication // same as @Configuration @EnableAutoConfiguration @ComponentScan
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@SpringBootApplication</code> 还提供别名以自定义 <code>@EnableAutoConfiguration</code> 和 <code>@ComponentScan</code> 的属性.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>这些功能都不是强制性的,您可以选择用它启用的任何功能替换此单个注解. 例如,您可能不想在应用程序中使用组件扫描或配置属性扫描:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block">package com.example.myapplication;

</span><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.context.annotation.ComponentScan
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableAutoConfiguration
@Import({ MyConfig.class, MyAnotherConfig.class })
public class Application {

    public static void main(String[] args) {
            SpringApplication.run(Application.class, args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>在此示例中,除了程序没有自动检测到 <code>@Component</code> 注解的类和 <code>@ConfigurationProperties</code> 注解的类和显式导入了用户定义的Bean之外,<code>Application</code> 就像其他任何 Spring Boot 应用程序一样 (请参阅 <code>@Import</code>) .</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-running-your-application"><a class="anchor" href="#using-boot-running-your-application"></a>7. 运行您的应用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>将应用程序打包成 jar 可执行文件并使用嵌入式 HTTP 服务器的最大优点之一就是可以按照您想使用的其它方式来运行应用. 调试 Spring Boot 也是很简单,您不需要任何特殊的 IDE 插件或者扩展.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
本章节仅涵盖基于　jar　的打包方式,如果您选择将应用打包为　war　文件,则应该参考您的服务器和　IDE　文档.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-boot-running-from-an-ide"><a class="anchor" href="#using-boot-running-from-an-ide"></a>7.1. 使用 IDE 运行</h3>
<div class="paragraph">
<p>您可以使用 IDE 运行 Spring Boot 应用,就像运行一个简单的 Java 应用程序一样,但是首先您需要导入项目,导入步骤取决于您的 IDE 和构建系统. 大多数 IDE 可以直接导入 Maven 项目,例如 Eclipse 用户可以从 <code>File</code> 菜单中选择  <code>Import&#8230;&#8203;</code> &#8594; <code>Existing Maven Projects</code> .</p>
</div>
<div class="paragraph">
<p>如果您无法将项目直接导入到 IDE 中,则可以使用构建插件生成 IDE 元数据 (metadata) . Maven 包含了 <a href="https://maven.apache.org/plugins/maven-eclipse-plugin/">Eclipse</a> 和 <a href="https://maven.apache.org/plugins/maven-idea-plugin/">IDEA</a> 的插件,Gradle 也为 <a href="https://docs.gradle.org/current/userguide/userguide.html">各种 IDE</a> 提供了插件.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
如果您不小心运行了两次 web 应用,您将看到一个 Port already in use  (端口已经被使用) 错误. STS 用户可以使用 <code>Relaunch</code> 按钮运行以确保现有的任何实例都已关闭,而不是使用 <code>Run</code> 按钮.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-running-as-a-packaged-application"><a class="anchor" href="#using-boot-running-as-a-packaged-application"></a>7.2. 作为打包应用运行</h3>
<div class="paragraph">
<p>如果您使用 Spring Boot Maven 或者 Gradle 插件创建可执行 jar,可以使用 <code>java -jar</code> 命令运行应用. 例如:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar target/myapplication-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>也可以在运行打包应用程序时开启远程调试支持. 该功能允许您将调试器附加到打包的应用中.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=8000,suspend=n \
       -jar target/myapplication-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-running-with-the-maven-plugin"><a class="anchor" href="#using-boot-running-with-the-maven-plugin"></a>7.3. 使用 Maven 插件</h3>
<div class="paragraph">
<p>Spring Boot Maven 插件包含一个可用于快速编译和运行应用程序的 <code>run</code> goal. 应用程序以快速形式运行,就像在 IDE 中一样. 以下示例展示了运行 Spring Boot 应用程序的典型 Maven 命令:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn spring-boot:run</pre>
</div>
</div>
<div class="paragraph">
<p>您可能还想使用 <code>MAVEN_OPTS</code> 操作系统环境变量,如下例所示:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ export MAVEN_OPTS=-Xmx1024m</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-running-with-the-gradle-plugin"><a class="anchor" href="#using-boot-running-with-the-gradle-plugin"></a>7.4. 使用 Gradle 插件</h3>
<div class="paragraph">
<p>Spring Boot Gradle 插件包含一个 <code>bootRun</code> 任务,可用于以快速形式运行应用程序. 每当应用 <code>org.springframework.boot</code> 和 java 插件时都会添加 <code>bootRun</code> 任务:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle bootRun</pre>
</div>
</div>
<div class="paragraph">
<p>您可能还想使用 <code>JAVA_OPTS</code> 操作系统环境变量:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ export JAVA_OPTS=-Xmx1024m</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-hot-swapping"><a class="anchor" href="#using-boot-hot-swapping"></a>7.5. 热交换</h3>
<div class="paragraph">
<p>由于 Spring Boot 应用程序只是普通的 Java 应用程序,因此 JVM 热插拔是可以开箱即用. JVM 热插拔在可替换字节码方面有所限制. 想要更完整的解决方案,可以使用 <a href="https://www.jrebel.com/products/jrebel">JRebel</a>.</p>
</div>
<div class="paragraph">
<p><code>spring-boot-devtools</code> 模块包含了对快速重新启动应用程序的支持. 有关详细信息,请参阅本章后面的 <a href="#using-boot-devtools">开发人员工具</a>部分以及<a href="howto.html#howto-hotswapping">热插拔的 How-to </a>  部分.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-devtools"><a class="anchor" href="#using-boot-devtools"></a>8. 开发者工具</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot 包含了一套工具,可以使应用开发体验更加愉快. <code>spring-boot-devtools</code> 模块可包含在任何项目中,以提供额外的开发时 (development-time) 功能. 要启用 devtools 支持,只需要将模块依赖添加到您的构建配置中即可:</p>
</div>
<div class="listingblock">
<div class="title">Maven</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">configurations {
    developmentOnly
    runtimeClasspath {
        extendsFrom developmentOnly
    }
}
dependencies {
    developmentOnly("org.springframework.boot:spring-boot-devtools")
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
当运行完全打包的应用时,开发者工具将会自动禁用. 如果您的应用使用了 <code>java -jar</code> 方式或者特殊的类加载器启动,那么它会被认为是一个生产级别应用. 你可以通过使用 <code>spring.devtools.restart.enabled</code> 系统属性来控制这种行为, 要启用devtools， 不管用什么类加载器来启动你的应用程序， 设置 <code>-Dspring.devtools.restart.enabled=true</code>  系统属性.  在运行devtools会带来安全风险的生产环境中， 绝对不能这样做,要禁用 <code>devtools</code> , 请排除依赖关系或设置 <code>-Dspring.devtools.restart.enabled = false</code> 系统属性.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
将 Maven 的依赖标记为可选或者在 Gradle 中使用 <code>developmentOnly</code> 是防止您的项目被其他模块使用时 devtools 被应用到其它模块的最佳方法.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
重新打包的归档默认情况下不包含 devtools. 如果要使用某些 <a href="#using-boot-devtools-remote">远程 devtools 功能</a>, 你需要禁用 <code>excludeDevtools</code> 构建属性以把 devtools 包含进来. 使用 Maven 插件时,请将 <code>excludeDevtools</code> 属性设置为 <code>false</code>.
使用 Gradle 插件时, <a href="https://docs.spring.io/spring-boot/docs/2.4.5/gradle-plugin/reference/htmlsingle/＃packaging-executable-configuring-includes-development-only-dependencies">将任务的类路径配置为包括 "developmentOnly" 配置</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-boot-devtools-property-defaults"><a class="anchor" href="#using-boot-devtools-property-defaults"></a>8.1. Property 默认值</h3>
<div class="paragraph">
<p>Spring Boot 所支持的一些库使用了缓存来提高性能. 例如, <a href="spring-boot-features.html#boot-features-spring-mvc-template-engines">模板引擎</a> 将缓存编译后的模板,以避免重复解析模板文件. 此外,Spring MVC 可以在服务静态资源时添加 HTTP 缓存头.</p>
</div>
<div class="paragraph">
<p>虽然缓存在生产中非常有用,但它在开发过程可能会产生相反的效果,让您不能及时看到刚才在应用中作出的更改. 因此,spring-boot-devtools 将默认禁用这些缓存选项.</p>
</div>
<div class="paragraph">
<p>一般是在 <code>application.properties</code> 文件中设置缓存选项. 例如,Thymeleaf 提供了 <code>spring.thymeleaf.cache</code> 属性. 您不需要手动设置这些属性,<code>spring-boot-devtools</code> 会自动应用合适的开发时 (development-time) 配置.</p>
</div>
<div class="paragraph">
<p>由于在开发 Spring MVC 和 Spring WebFlux 应用程序时需要有关 Web 请求的更多信息,因此开发者工具将为 <code>Web</code> 日志记录组启用 <code>DEBUG</code> 日志记录.  这将为您提供有关传入请求,正在处理的处理程序,响应结果等的信息. 如果您希望记录所有请求详细信息 (包括潜在的敏感信息) ,
则可以打开 <code>spring.mvc.log-request-details</code> 配置属性.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
如果您不希望应用默认属性,则可以在 <code>application.properties</code> 中将 <code>spring.devtools.add-properties</code> 设置为 <code>false</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
有关 devtools 应用的属性的完整列表,请参见 <a href="https://github.com/spring-projects/spring-boot/blob/2.4.x/spring-boot-project/spring-boot-devtools/src/main/java/org/springframework/boot/devtools/env/DevToolsPropertyDefaultsPostProcessor.java">DevToolsPropertyDefaultsPostProcessor</a>. .
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-devtools-restart"><a class="anchor" href="#using-boot-devtools-restart"></a>8.2. 自动重启</h3>
<div class="paragraph">
<p>使用 <code>spring-boot-devtools</code> 的应用在 classpath 下的文件发生更改时会自动重启. 这对于使用 IDE 工作而言可能是一个非常棒的功能,因为它为代码变更提供了非常快的反馈.
默认情况下,将监视 classpath 指向的所有目录. 请注意,某些资源 (如静态资源和视图模板) <a href="#using-boot-devtools-restart-exclude">不需要重启应用</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">触发重启</div>
<div class="paragraph">
<p>当 DevTools 监视 classpath 资源时,触发重启的唯一方式是更新 classpath. 使 classpath 更新的方式取决于您使用的 IDE.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>在 Eclipse 中,保存修改的文件将更新 classpath,从而触发重启.</p>
</li>
<li>
<p>在 IntelliJ IDEA 中,构建项目 (<code>Build +&#8594;+ Build Project</code>) 将产生相同的效果.</p>
</li>
<li>
<p>如果使用构建插件,Maven 运行 <code>mvn compile</code> 或 Gradle 运行 <code>gradle build</code> 将触发重启.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只要 forking 被开启,您可以使用受支持的构建工具 (如 Maven 或 Gradle) 来重启应用,因为 DevTools 需要隔离应用类加载器才能正常运行. 默认情况下,当在 classpath 下检测到 DevTools 时,Gradle 和 Maven 会这么做.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
自动重启功能与 LiveReload (实时重载) 一起使用效果更棒. 阅读 <a href="#using-boot-devtools-livereload">LiveReload</a> 章节以获取更多信息. 如果您使用 JRebel,自动重启将会被禁用,以支持动态类重载,但其他 devtools 功能 (如 LiveReload 和 property 覆盖) 仍然可以使用.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DevTools 依赖于应用上下文的关闭钩子,以在重启期间关闭自己. 如果禁用了关闭钩子 (<code>SpringApplication.setRegisterShutdownHook(false)</code> ) ,它将不能正常工作.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DevTools 需要自定义 <code>ApplicationContext</code> 使用到的 <code>ResourceLoader</code>. 如果您的应用已经提供了一个,它将被包装起来,因为不支持在 <code>ApplicationContext</code> 上直接覆盖 <code>getResource</code> 方法.
</td>
</tr>
</table>
</div>
<div id="using-spring-boot-restart-vs-reload" class="sidebarblock">
<div class="content">
<div class="title">重启 (Restart) 与重载 (Reload)</div>
<div class="paragraph">
<p>Spring Boot 通过使用两个类加载器来提供了重启技术. 不改变的类 (例如,第三方 jar) 被加载到 <em>base</em> 类加载器中. 经常处于开发状态的类被加载到 <em>restart</em> 类加载器中. 当应用重启时,<em>restart</em> 类加载器将被丢弃,并重新创建一个新的. 这种方式意味着应用重启比冷启动要快得多,因为省去 <em>base</em> 类加载器的处理步骤,并且可以直接使用.</p>
</div>
<div class="paragraph">
<p>如果您觉得重启还不够快,或者遇到类加载问题,您可以考虑如 ZeroTurnaround 的 <a href="https://jrebel.com/software/jrebel/">JRebel</a> 等工具. 他们是通过在加载类时重写类来加快重新加载.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-restart-logging-condition-delta"><a class="anchor" href="#using-boot-devtools-restart-logging-condition-delta"></a>8.2.1. 条件评估变更日志</h4>
<div class="paragraph">
<p>默认情况下,每次应用重启时,都会记录显示条件评估增量的报告. 该报告展示了在您进行更改 (如添加或删除 bean 以及设置配置属性) 时对应用自动配置所作出的更改.</p>
</div>
<div class="paragraph">
<p>要禁用报告的日志记录,请设置以下属性:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  devtools:
    restart:
      log-condition-evaluation-delta: false</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-restart-exclude"><a class="anchor" href="#using-boot-devtools-restart-exclude"></a>8.2.2. 排除资源</h4>
<div class="paragraph">
<p>某些资源在更改时不一定需要触发重启. 例如,Thymeleaf 模板可以实时编辑. 默认情况下,更改  <code>/META-INF/maven</code>、<code>/META-INF/resources</code>、<code>/resources</code>、<code>/static</code>、<code>/public</code> 或者 <code>/templates</code> 不会触发重启,
但会触发 <a href="#using-boot-devtools-livereload">live reload</a>. 如果您想自定义排除项,可以使用 <code>spring.devtools.restart.exclude</code> 属性. 例如,仅排除 <code>/static</code> 和 <code>/public</code>,您可以设置以下内容:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  devtools:
    restart:
      exclude: "static/**,public/**"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
如果要保留这些默认值并添加其他排除项 ,请改用 <code>spring.devtools.restart.additional-exclude</code> 属性.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-restart-additional-paths"><a class="anchor" href="#using-boot-devtools-restart-additional-paths"></a>8.2.3. 监视附加路径</h4>
<div class="paragraph">
<p>如果您想在对不在 classpath 下的文件进行修改时重启或重载应用,请使用 <code>spring.devtools.restart.additional-paths</code> 属性来配置监视其他路径的更改情况. 您可以使用<a href="#using-boot-devtools-restart-exclude">上述</a>的  <code>spring.devtools.restart.exclude</code> 属性来控制附加路径下的文件被修改时是否触发重启或只是 <a href="#using-boot-devtools-livereload">live reload</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-restart-disable"><a class="anchor" href="#using-boot-devtools-restart-disable"></a>8.2.4. 禁用重启</h4>
<div class="paragraph">
<p>您如果不想使用重启功能,可以使用 <code>spring.devtools.restart.enabled</code> 属性来禁用它. 一般情况下,您可以在 <code>application.properties</code> 中设置此属性 (重启类加载器仍将被初始化,但不会监视文件更改) .</p>
</div>
<div class="paragraph">
<p>如果您需要完全禁用重启支持 (例如,可能它不适用于某些类库) ,您需要在调用 <code>SpringApplication.run(&#8230;&#8203;)</code> 之前将 System 属性 <code>spring.devtools.restart.enabled</code> <code>System</code> 设置为 <code>false</code>. 例如:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(String[] args) {
    System.setProperty("spring.devtools.restart.enabled", "false");
    SpringApplication.run(MyApp.class, args);
}
</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-restart-triggerfile"><a class="anchor" href="#using-boot-devtools-restart-triggerfile"></a>8.2.5. 使用触发文件</h4>
<div class="paragraph">
<p>如果您使用 IDE 进行开发,并且时时刻刻在编译更改的文件,或许您只是希望在特定的时间内触发重启. 为此,您可以使用触发文件,这是一个特殊文件,您想要触发重启检查时,必须修改它.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
更改文件只会触发检查,只有在 Devtools 检查到它需要做某些操作时才会触发重启,可以手动更新触发文件,也可以通过 IDE 插件更新.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>要使用触发文件,请设置 <code>spring.devtools.restart.trigger-file</code> 属性指向触发文件的路径.</p>
</div>
<div class="paragraph">
<p>例如,如果您的项目具有以下结构:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>src
+- main
   +- resources
      +- .reloadtrigger</pre>
</div>
</div>
<div class="paragraph">
<p>然后,您的触发文件属性将是:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  devtools:
    restart:
      trigger-file: ".reloadtrigger"</code></pre>
</div>
</div>
<div class="paragraph">
<p>现在仅在更新 <code>src/main/resources/.reloadtrigger</code> 时才发生重启.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
您也许想将 <code>spring.devtools.restart.trigger-file</code> 设置成一个<a href="#using-boot-devtools-globalsettings">全局配置</a>,以使得所有的项目都能应用此方式.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>某些IDE具有使您不必手动更新触发器文件的功能.  <a href="https://spring.io/tools">Spring Tools for Eclipse</a> 的Spring工具和  <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA (Ultimate Edition)</a> 都具有这种支持.  使用Spring Tools,
您可以从控制台视图使用 "重新加载" 按钮 (只要您的 <code>trigger-file</code> 名为 <code>.reloadtrigger</code>) .  对于IntelliJ,您可以按照其 <a href="https://www.jetbrains.com/help/idea/spring-boot.html#configure-application-update-policies-with-devtools">文档中的说明</a> 进行操作.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-customizing-classload"><a class="anchor" href="#using-boot-devtools-customizing-classload"></a>8.2.6. 自定义重启类加载器</h4>
<div class="paragraph">
<p>正如之前的 <a href="#using-spring-boot-restart-vs-reload">重启和重载</a> 部分所述,重启功能是通过使用两个类加载器来实现的. 对于大多数应用而言,这种方式很好,然而,有时可能会导致类加载出现问题.</p>
</div>
<div class="paragraph">
<p>默认情况下,IDE 中任何打开的项目将使用  &#8220;restart&#8221;  类加载器加载,任何常规的 <code>.jar</code> 文件将使用 base 类加载器加载. 您如果开发的是多模块项目,而不是每一个模块都导入到 IDE 中,则可能需要自定义. 为此,您可以创建一个  <code>META-INF/spring-devtools.properties</code> 文件.</p>
</div>
<div class="paragraph">
<p><code>spring-devtools.properties</code> 文件可以包含以 <code>restart.exclude</code>. 和 <code>restart.include</code>. 为前缀的属性. <code>include</code> 元素是加载到 <code>restart</code> 类加载器的项,<code>exclude</code> 元素是加载到  &#8220;base&#8221;  类加载器的项. 属性值是一个应用到 classpath 的正则表达式. 例如:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">restart:
  exclude:
    companycommonlibs: "/mycorp-common-[\\w\\d-\\.]+\\.jar"
  include:
    projectcommon: "/mycorp-myproj-[\\w\\d-\\.]+\\.jar"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
所有属性键名必须是唯一的. 只要有一个属性以 <code>restart.include</code>. 或 <code>restart.exclude</code>. 开头,它将会被考虑.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
classpath 下的所有 <code>META-INF/spring-devtools.properties</code> 文件将被加载,您可以将它们打包进工程或者类库中为项目所用.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-known-restart-limitations"><a class="anchor" href="#using-boot-devtools-known-restart-limitations"></a>8.2.7. 已知限制</h4>
<div class="paragraph">
<p>重新启动功能对使用标准 <code>ObjectInputStream</code> 反序列化的对象无效. 您如果需要反序列化数据,可能需要使用 Spring 的 <code>ConfigurableObjectInputStream</code> 配合 <code>Thread.currentThread().getContextClassLoader()</code>.</p>
</div>
<div class="paragraph">
<p>遗憾的是,一些第三方类库在没有考虑上下文类加载器的情况下使用了反序列化. 您如果遇到此问题,需要向原作者提交修复请求.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-devtools-livereload"><a class="anchor" href="#using-boot-devtools-livereload"></a>8.3. LiveReload</h3>
<div class="paragraph">
<p><code>spring-boot-devtools</code> 模块包括了一个内嵌 <code>LiveReload</code> 服务器,它可在资源发生更改时触发浏览器刷新. 您可以从 <a href="http://livereload.com/extensions/">livereload.com</a> 上免费获取 Chrome、Firefox 和 Safari 平台下对应的 LiveReload 浏览器扩展程序.</p>
</div>
<div class="paragraph">
<p>如果您不想在应用运行时启动 LiveReload 服务器,可以将 <code>spring.devtools.livereload.enabled</code> 属性设置为 <code>false</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
您一次只能运行一个 LiveReload 服务器. 在启动应用之前,请确保没有其他 LiveReload 服务器正在运行. 如果在 IDE 中启动了多个应用,那么只有第一个应用的 LiveReload 生效.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
要在文件更改时触发 LiveReload,必须启用 <a href="#using-boot-devtools-restart">自动重启</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-devtools-globalsettings"><a class="anchor" href="#using-boot-devtools-globalsettings"></a>8.4. 全局设置</h3>
<div class="paragraph">
<p>您可以通过将以下任何文件添加到 <code>$HOME/.config/spring-boot</code> 目录来配置全局 devtools 设置:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>spring-boot-devtools.properties</code></p>
</li>
<li>
<p><code>spring-boot-devtools.yaml</code></p>
</li>
<li>
<p><code>spring-boot-devtools.yml</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>在此文件中添加的任何属性将应用到您的计算机上所有使用了 devtools 的 Spring Boot 应用. 例如,始终使用<a href="#using-boot-devtools-restart-triggerfile">触发文件</a>来配置重启功能,您需要将以下属性添加到您的 <code>spring-boot-devtools</code> 文件中: :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  devtools:
    restart:
      trigger-file: ".reloadtrigger"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
如果在 <code>$HOME/.config/spring-boot</code> 中找不到 devtools 配置文件,则在 $HOME 目录的根目录中搜索是否存在 <code>.spring-boot-devtools.properties</code> 文件.  这使您可以与不支持 <code>$HOME/.config/spring-boot</code> 位置的较旧版本的 Spring Boot 上的应用程序共享 devtools 全局配置.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
在上述文件中激活的配置文件不会影响 <a href="spring-boot-features.html#boot-features-external-config-files-profile-specific">指定 profile 的配置文件</a>的加载. .
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Profiles 不支持 devtools properties/yaml 文件.</p>
</div>
<div class="paragraph">
<p>任何在 <code>.spring-boot-devtools.properties</code> 中激活的 profiles 不会影响 <a href="spring-boot-features.html#boot-features-external-config-files-profile-specific">指定 profile 的配置文件</a> 的加载.
不支持在 YAML 和 Properties 文件中的配置特定于配置文件的文件名(格式为  <code>spring-boot-devtools-&lt;profile&gt;.properties</code>) 和  <code>spring.config.activate.on-profile</code>  子文档.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="configuring-file-system-watcher"><a class="anchor" href="#configuring-file-system-watcher"></a>8.4.1. 配置文件系统监视器</h4>
<div class="paragraph">
<p><a href="https://github.com/spring-projects/spring-boot/blob/2.4.x/spring-boot-project/spring-boot-devtools/src/main/java/org/springframework/boot/devtools/filewatch/FileSystemWatcher.java">FileSystemWatcher</a>  的工作方式是按一定的时间间隔轮询更改类,然后等待定义好的一段时间以确保没有更多更改.
由于 Spring Boot 完全依赖 IDE 来编译文件并将其复制到 Spring Boot 可以读取文件的位置,因此您可能会发现,有时 devtools 重新启动应用程序时某些更改未反映出来.
如果您经常观察到此类问题,请尝试将 <code>spring.devtools.restart.poll-interval</code> 和 <code>spring.devtools.restart.quiet-period</code> 参数增加到适合您开发环境的值:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  devtools:
    restart:
      poll-interval: "2s"
      quiet-period: "1s"</code></pre>
</div>
</div>
<div class="paragraph">
<p>现在每 2 秒轮询一次受监视的 <code>classpath</code> 目录是否有更改,并保持 1 秒钟的静默时间以确保没有其他类更改.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-boot-devtools-remote"><a class="anchor" href="#using-boot-devtools-remote"></a>8.5. 远程应用</h3>
<div class="paragraph">
<p>Spring Boot 开发者工具不局限于本地开发. 在远程运行应用时也可以使用许多功能. 远程支持功能是可选的,您还可以使用多种功能.  选择启用远程支持,因为启用它可能会带来安全风险.  仅当在受信任的网络上运行或使用 SSL 保护时,才应启用它.  如果这两个选项都不可用,则不应使用 DevTools 的远程支持.  您永远不要在生产部署上启用.
如果要启用,您需要确保在重新打包归档文件时包含 <code>devtools</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;excludeDevtools&gt;false&lt;/excludeDevtools&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>之后您需要设置一个 <code>spring.devtools.remote.secret</code> 属性,像任何重要的密码或机密一样,该值应唯一且强壮,以免被猜测或强行使用.</p>
</div>
<div class="paragraph">
<p>远程 devtools 支持分为两部分: 接受连接的服务器端端点和在 IDE 中运行的客户端应用程序.  设置 <code>spring.devtools.remote.secret</code> 属性后,将自动启用服务器组件.  客户端组件必须手动启动.</p>
</div>
<div class="sect3">
<h4 id="运行远程客户端应用"><a class="anchor" href="#运行远程客户端应用"></a>8.5.1. 运行远程客户端应用</h4>
<div class="paragraph">
<p>假设远程客户端应用运行在 IDE 中. 您需要在与要连接的远程项目相同的 classpath 下运行  <code>org.springframework.boot.devtools.RemoteSpringApplication</code> . 把要连接的远程 URL 作为必须参数传入.</p>
</div>
<div class="paragraph">
<p>例如,如果您使用的是 Eclipse 或 STS,并且有一个名为 <code>my-app</code> 的项目已部署到了 Cloud Foundry,则可以执行以下操作:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>在 <code>Run</code> 菜单中选择选择 <code>Run Configurations&#8230;&#8203;</code>.</p>
</li>
<li>
<p>创建一个新的 <code>Java Application</code>  &#8220;launch configuration&#8221;.</p>
</li>
<li>
<p>浏览 <code>my-app</code> 项目.</p>
</li>
<li>
<p>使用  <code>org.springframework.boot.devtools.RemoteSpringApplication</code> 作为主类.</p>
</li>
<li>
<p>将  <code>https://myapp.cfapps.io</code> 作为  <code>Program arguments</code>  (或者任何远程 URL) 传入.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>运行的远程客户端将如下所示:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  .   ____          _                                              __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _          ___               _      \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` |        | _ \___ _ __  ___| |_ ___ \ \ \ \
 \\/  ___)| |_)| | | | | || (_| []::::::[]   / -_) '  \/ _ \  _/ -_) ) ) ) )
  '  |____| .__|_| |_|_| |_\__, |        |_|_\___|_|_|_\___/\__\___|/ / / /
 =========|_|==============|___/===================================/_/_/_/
 :: Spring Boot Remote :: 2.4.5

2015-06-10 18:25:06.632  INFO 14938 --- [           main] o.s.b.devtools.RemoteSpringApplication   : Starting RemoteSpringApplication on pwmbp with PID 14938 (/Users/pwebb/projects/spring-boot/code/spring-boot-project/spring-boot-devtools/target/classes started by pwebb in /Users/pwebb/projects/spring-boot/code)
2015-06-10 18:25:06.671  INFO 14938 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@2a17b7b6: startup date [Wed Jun 10 18:25:06 PDT 2015]; root of context hierarchy
2015-06-10 18:25:07.043  WARN 14938 --- [           main] o.s.b.d.r.c.RemoteClientConfiguration    : The connection to http://localhost:8080 is insecure. You should use a URL starting with 'https://'.
2015-06-10 18:25:07.074  INFO 14938 --- [           main] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2015-06-10 18:25:07.130  INFO 14938 --- [           main] o.s.b.devtools.RemoteSpringApplication   : Started RemoteSpringApplication in 0.74 seconds (JVM running for 1.105)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
由于远程客户端与实际应用使用的是同一个 classpath,因此可以直接读取应用的 properties. 这也是 <code>spring.devtools.remote.secret</code>  属性为什么能被读取和传递给服务器进行身份验证的原因.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
建议使用 <code>https://</code> 作为连接协议,以便加密传输并防止密码被拦截.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
如果您需要通过代理来访问远程应用,请配置 <code>spring.devtools.remote.proxy.host</code> 和 <code>spring.devtools.remote.proxy.port</code> 属性.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using-boot-devtools-remote-update"><a class="anchor" href="#using-boot-devtools-remote-update"></a>8.5.2. 远程更新</h4>
<div class="paragraph">
<p>远程客户端使用了与<a href="#using-boot-devtools-restart">本地重启</a>相同的方式来监控应用 classpath 下发生的更改. 任何更新的资源将被推送到远程应用和触发重启 (如果要求) . 如果您正在迭代一个使用了本地没有的云服务的功能,这可能会非常有用. 通常远程更新和重启比完全重新构建和部署的周期要快得多.</p>
</div>
<div class="paragraph">
<p>在较慢的开发环境中,可能会发生静默期不够的情况,并且类中的更改可能会分为几批.  第一批类更改上传后,服务器将重新启动.  由于服务器正在重新启动,因此下一批不能发送到应用程序.</p>
</div>
<div class="paragraph">
<p>这通常通过 <code>RemoteSpringApplication</code> 日志中的警告来证明,即有关上载某些类失败的消息,然后进行重试.  但是,这也可能导致应用程序代码不一致,并且在上传第一批更改后无法重新启动.</p>
</div>
<div class="paragraph">
<p>如果您经常观察到此类问题,请尝试将 <code>spring.devtools.restart.poll-interval</code> 和 <code>spring.devtools.restart.quiet-period</code> 参数增加到适合您的开发环境的值:
请参阅 <a href="#configuring-file-system-watcher">配置文件系统监视器</a> 部分以配置这些属性.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
文件只有在远程客户端运行时才被监控. 如果您在启动远程客户端之前更改了文件,文件将不会被推送到远程服务器.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-packaging-for-production"><a class="anchor" href="#using-boot-packaging-for-production"></a>9. 打包生产应用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>可执行 jar 可用于生产部署,它们是独立 (self-contained,独立、自包含) 的,同样也适合云部署.</p>
</div>
<div class="paragraph">
<p>针对其他生产就绪功能,比如健康、审计和 REST 或者 JMX 端点指标,可以添加 spring-boot-actuator. 有关这方面的详细信息,请参见 <em><a href="production-ready-features.html#production-ready">Spring Boot Actuator: 生产就绪功能</a></em> .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-whats-next"><a class="anchor" href="#using-boot-whats-next"></a>10. 下一步</h2>
<div class="sectionbody">
<div class="paragraph">
<p>您现在应该知道如何使用 Spring Boot 以及应该遵循哪些最佳实践.
接下来您可以深入地了解  <em><a href="spring-boot-features.html#boot-features">Spring Boot 特性</a></em>,或者您也可以跳过下一部分直接阅读 &#8220;<a href="production-ready-features.html#production-ready">生产就绪功能</a>&#8221; 方面的内容.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-09-13 15:54:50 +0800
</div>
</div>
</div>
  </div>
</div>
</body>
</html>