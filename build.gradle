buildscript {
    repositories {
        maven {
            url 'https://maven.aliyun.com/repository/gradle-plugin'
        }
        maven {
            url 'https://maven.aliyun.com/repository/spring-plugin'
        }
    }
}

plugins {
    id 'org.springframework.boot' version '2.3.8.RELEASE' apply false
    id 'io.spring.dependency-management' version '1.0.9.RELEASE' apply false
    id 'org.asciidoctor.jvm.convert'
    id "org.asciidoctor.jvm.pdf"
    id 'de.undercouch.download' version '4.0.0'
}


// 获取命令行参数,以指定不同的构建环境
if (!hasProperty("language")) ext.language = "zh-cn"

configure(allprojects) { project ->
    apply plugin: "io.spring.dependency-management"
    dependencyManagement {
        repositories {
            maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
            mavenCentral()
            maven { url "https://repo.spring.io/libs-spring-framework-build" }
            maven { url "https://repo.spring.io/snapshot" }
        }
    }


//    dependencies {
//        api("org.asciidoctor:asciidoctor-gradle-jvm:3.0.0")
//        api("org.asciidoctor:asciidoctor-gradle-jvm-pdf:3.0.0")
//    }
}


configure(subprojects) { subproject ->
    apply from: "${rootDir}/gradle/dependencies.gradle"
    apply from: "${rootDir}/gradle/docs.gradle"
}

task docsZip(type: Zip) {
    group = "Distribution"
    description = "Builds -${archiveClassifier} archive containing api and reference " +
            "for deployment at http://docs.jcohy.com"

    archiveBaseName.set("jcohy")
    archiveClassifier.set("docs")

    from ("$buildDir/docs") {
        into "docs/"
    }
}
